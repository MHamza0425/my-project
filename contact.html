<script>
document.getElementById("contactForm").addEventListener("submit", async function (e) {
  e.preventDefault();
  
  const name = document.getElementById("name").value.trim();
  const email = document.getElementById("email").value.trim();
  const message = document.getElementById("message").value.trim();

  // Reset message styling
  const responseEl = document.getElementById("responseMessage");
  responseEl.innerText = "";
  responseEl.classList.remove("text-green-600", "text-red-600");

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbxG-Yik9oXUzcPZ4cAAfb6NCujbZR0PZFvnkD7Wk3BH2793gjNFfKYlA4Tpz7firVPAmw/exec", {
      method: "POST",
      body: JSON.stringify({ name, email, message })
    });

    const result = await response.json();

    if (result.result === "success") {
      responseEl.innerText = "✅ Thanks for contacting us, " + name + "! We’ve received your message.";
      responseEl.classList.add("text-green-600");
      document.getElementById("contactForm").reset();
    } else {
      responseEl.innerText = "❌ Error: " + result.error;
      responseEl.classList.add("text-red-600");
    }
  } catch (err) {
    responseEl.innerText = "❌ Network error. Please try again.";
    responseEl.classList.add("text-red-600");
    console.error("Fetch error:", err);
  }
});
</script>
